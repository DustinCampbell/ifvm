// <auto-generated />

using System.Collections.Immutable;

namespace IFVM.Ast
{
    public enum AstNodeKind
    {
        Label,
        Local,
        ConstantExpression,
        ConversionExpression,
        AddExpression,
        SubtractExpression,
        MultiplyExpression,
        DivideExpression,
        ModuloExpression,
        EqualToExpression,
        NotEqualToExpression,
        LessThanExpression,
        LessThanOrEqualToExpression,
        GreaterThanExpression,
        GreaterThanOrEqualToExpression,
        CallExpression,
        CallWithArgCountExpression,
        StackPopExpression,
        ReadLocalExpression,
        ReadMemoryExpression,
        GetMemorySize,
        DispatchExpression,
        ExpressionStatement,
        LabelStatement,
        BranchStatement,
        JumpStatement,
        ReturnStatement,
        QuitStatement,
        StackPushStatement,
        StackCopyStatement,
        WriteLocalStatement,
        WriteMemoryStatement,
        OutputCharStatement,
        OutputNumberStatement,
        OutputStringStatement,
        RestoreUndoStatement,
    }

    public partial class AstLabel : AstNode
    {
        private readonly int index;

        internal AstLabel(int index) : base(AstNodeKind.Label)
        {
            this.index = index;
        }

        public int Index
        {
            get { return this.index; }
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitLabel(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitLabel(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            return ImmutableList<AstNode>.Empty;
        }
    }

    public partial class AstLocal : AstNode
    {
        private readonly AstExpression index;
        private readonly ValueSize size;

        internal AstLocal(AstExpression index, ValueSize size) : base(AstNodeKind.Local)
        {
            this.index = index;
            this.size = size;
        }

        public AstExpression Index
        {
            get { return this.index; }
        }

        public ValueSize Size
        {
            get { return this.size; }
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitLocal(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitLocal(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Index);

            return builder.ToImmutable();
        }
    }

    public abstract partial class AstExpression : AstNode
    {
        internal AstExpression(AstNodeKind kind) : base(kind)
        {
        }
    }

    public abstract partial class AstBinaryExpression : AstExpression
    {
        private readonly AstExpression left;
        private readonly AstExpression right;

        internal AstBinaryExpression(AstNodeKind kind, AstExpression left, AstExpression right) : base(kind)
        {
            this.left = left;
            this.right = right;
        }

        public AstExpression Left
        {
            get { return this.left; }
        }

        public AstExpression Right
        {
            get { return this.right; }
        }
    }

    public abstract partial class AstUnaryExpression : AstExpression
    {
        private readonly AstExpression expression;

        internal AstUnaryExpression(AstNodeKind kind, AstExpression expression) : base(kind)
        {
            this.expression = expression;
        }

        public AstExpression Expression
        {
            get { return this.expression; }
        }
    }

    public partial class AstConstantExpression : AstExpression
    {
        private readonly int value;

        internal AstConstantExpression(int value) : base(AstNodeKind.ConstantExpression)
        {
            this.value = value;
        }

        public int Value
        {
            get { return this.value; }
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitConstantExpression(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitConstantExpression(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            return ImmutableList<AstNode>.Empty;
        }
    }

    public partial class AstConversionExpression : AstExpression
    {
        private readonly AstExpression expression;
        private readonly ValueSize size;
        private readonly bool signed;

        internal AstConversionExpression(AstExpression expression, ValueSize size, bool signed) : base(AstNodeKind.ConversionExpression)
        {
            this.expression = expression;
            this.size = size;
            this.signed = signed;
        }

        public AstExpression Expression
        {
            get { return this.expression; }
        }

        public ValueSize Size
        {
            get { return this.size; }
        }

        public bool Signed
        {
            get { return this.signed; }
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitConversionExpression(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitConversionExpression(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Expression);

            return builder.ToImmutable();
        }
    }

    public partial class AstAddExpression : AstBinaryExpression
    {
        internal AstAddExpression(AstExpression left, AstExpression right) : base(AstNodeKind.AddExpression, left, right)
        {
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitAddExpression(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitAddExpression(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Left);
            builder.Add(Right);

            return builder.ToImmutable();
        }
    }

    public partial class AstSubtractExpression : AstBinaryExpression
    {
        internal AstSubtractExpression(AstExpression left, AstExpression right) : base(AstNodeKind.SubtractExpression, left, right)
        {
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitSubtractExpression(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitSubtractExpression(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Left);
            builder.Add(Right);

            return builder.ToImmutable();
        }
    }

    public partial class AstMultiplyExpression : AstBinaryExpression
    {
        internal AstMultiplyExpression(AstExpression left, AstExpression right) : base(AstNodeKind.MultiplyExpression, left, right)
        {
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitMultiplyExpression(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitMultiplyExpression(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Left);
            builder.Add(Right);

            return builder.ToImmutable();
        }
    }

    public partial class AstDivideExpression : AstBinaryExpression
    {
        internal AstDivideExpression(AstExpression left, AstExpression right) : base(AstNodeKind.DivideExpression, left, right)
        {
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitDivideExpression(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitDivideExpression(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Left);
            builder.Add(Right);

            return builder.ToImmutable();
        }
    }

    public partial class AstModuloExpression : AstBinaryExpression
    {
        internal AstModuloExpression(AstExpression left, AstExpression right) : base(AstNodeKind.ModuloExpression, left, right)
        {
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitModuloExpression(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitModuloExpression(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Left);
            builder.Add(Right);

            return builder.ToImmutable();
        }
    }

    public partial class AstEqualToExpression : AstBinaryExpression
    {
        internal AstEqualToExpression(AstExpression left, AstExpression right) : base(AstNodeKind.EqualToExpression, left, right)
        {
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitEqualToExpression(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitEqualToExpression(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Left);
            builder.Add(Right);

            return builder.ToImmutable();
        }
    }

    public partial class AstNotEqualToExpression : AstBinaryExpression
    {
        internal AstNotEqualToExpression(AstExpression left, AstExpression right) : base(AstNodeKind.NotEqualToExpression, left, right)
        {
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitNotEqualToExpression(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitNotEqualToExpression(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Left);
            builder.Add(Right);

            return builder.ToImmutable();
        }
    }

    public partial class AstLessThanExpression : AstBinaryExpression
    {
        internal AstLessThanExpression(AstExpression left, AstExpression right) : base(AstNodeKind.LessThanExpression, left, right)
        {
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitLessThanExpression(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitLessThanExpression(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Left);
            builder.Add(Right);

            return builder.ToImmutable();
        }
    }

    public partial class AstLessThanOrEqualToExpression : AstBinaryExpression
    {
        internal AstLessThanOrEqualToExpression(AstExpression left, AstExpression right) : base(AstNodeKind.LessThanOrEqualToExpression, left, right)
        {
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitLessThanOrEqualToExpression(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitLessThanOrEqualToExpression(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Left);
            builder.Add(Right);

            return builder.ToImmutable();
        }
    }

    public partial class AstGreaterThanExpression : AstBinaryExpression
    {
        internal AstGreaterThanExpression(AstExpression left, AstExpression right) : base(AstNodeKind.GreaterThanExpression, left, right)
        {
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitGreaterThanExpression(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitGreaterThanExpression(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Left);
            builder.Add(Right);

            return builder.ToImmutable();
        }
    }

    public partial class AstGreaterThanOrEqualToExpression : AstBinaryExpression
    {
        internal AstGreaterThanOrEqualToExpression(AstExpression left, AstExpression right) : base(AstNodeKind.GreaterThanOrEqualToExpression, left, right)
        {
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitGreaterThanOrEqualToExpression(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitGreaterThanOrEqualToExpression(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Left);
            builder.Add(Right);

            return builder.ToImmutable();
        }
    }

    public partial class AstCallExpression : AstExpression
    {
        private readonly AstExpression address;
        private readonly ImmutableList<AstExpression> arguments;

        internal AstCallExpression(AstExpression address, ImmutableList<AstExpression> arguments) : base(AstNodeKind.CallExpression)
        {
            this.address = address;
            this.arguments = arguments;
        }

        public AstExpression Address
        {
            get { return this.address; }
        }

        public ImmutableList<AstExpression> Arguments
        {
            get { return this.arguments; }
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitCallExpression(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitCallExpression(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Address);
            foreach (var child in Arguments)
            {
                builder.Add(child);
            }

            return builder.ToImmutable();
        }
    }

    public partial class AstCallWithArgCountExpression : AstExpression
    {
        private readonly AstExpression address;
        private readonly AstExpression argumentCount;

        internal AstCallWithArgCountExpression(AstExpression address, AstExpression argumentCount) : base(AstNodeKind.CallWithArgCountExpression)
        {
            this.address = address;
            this.argumentCount = argumentCount;
        }

        public AstExpression Address
        {
            get { return this.address; }
        }

        public AstExpression ArgumentCount
        {
            get { return this.argumentCount; }
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitCallWithArgCountExpression(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitCallWithArgCountExpression(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Address);
            builder.Add(ArgumentCount);

            return builder.ToImmutable();
        }
    }

    public partial class AstStackPopExpression : AstExpression
    {
        internal AstStackPopExpression() : base(AstNodeKind.StackPopExpression)
        {
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitStackPopExpression(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitStackPopExpression(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            return ImmutableList<AstNode>.Empty;
        }
    }

    public partial class AstReadLocalExpression : AstExpression
    {
        private readonly AstLocal local;

        internal AstReadLocalExpression(AstLocal local) : base(AstNodeKind.ReadLocalExpression)
        {
            this.local = local;
        }

        public AstLocal Local
        {
            get { return this.local; }
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitReadLocalExpression(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitReadLocalExpression(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Local);

            return builder.ToImmutable();
        }
    }

    public partial class AstReadMemoryExpression : AstExpression
    {
        private readonly AstExpression address;
        private readonly ValueSize size;

        internal AstReadMemoryExpression(AstExpression address, ValueSize size) : base(AstNodeKind.ReadMemoryExpression)
        {
            this.address = address;
            this.size = size;
        }

        public AstExpression Address
        {
            get { return this.address; }
        }

        public ValueSize Size
        {
            get { return this.size; }
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitReadMemoryExpression(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitReadMemoryExpression(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Address);

            return builder.ToImmutable();
        }
    }

    public partial class AstGetMemorySize : AstExpression
    {
        internal AstGetMemorySize() : base(AstNodeKind.GetMemorySize)
        {
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitGetMemorySize(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitGetMemorySize(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            return ImmutableList<AstNode>.Empty;
        }
    }

    public partial class AstDispatchExpression : AstExpression
    {
        private readonly DispatchFunction function;
        private readonly ImmutableList<AstExpression> arguments;

        internal AstDispatchExpression(DispatchFunction function, ImmutableList<AstExpression> arguments) : base(AstNodeKind.DispatchExpression)
        {
            this.function = function;
            this.arguments = arguments;
        }

        public DispatchFunction Function
        {
            get { return this.function; }
        }

        public ImmutableList<AstExpression> Arguments
        {
            get { return this.arguments; }
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitDispatchExpression(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitDispatchExpression(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            foreach (var child in Arguments)
            {
                builder.Add(child);
            }

            return builder.ToImmutable();
        }
    }

    public abstract partial class AstStatement : AstNode
    {
        internal AstStatement(AstNodeKind kind) : base(kind)
        {
        }
    }

    public partial class AstExpressionStatement : AstStatement
    {
        private readonly AstExpression expression;

        internal AstExpressionStatement(AstExpression expression) : base(AstNodeKind.ExpressionStatement)
        {
            this.expression = expression;
        }

        public AstExpression Expression
        {
            get { return this.expression; }
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitExpressionStatement(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitExpressionStatement(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Expression);

            return builder.ToImmutable();
        }
    }

    public partial class AstLabelStatement : AstStatement
    {
        private readonly AstLabel label;

        internal AstLabelStatement(AstLabel label) : base(AstNodeKind.LabelStatement)
        {
            this.label = label;
        }

        public AstLabel Label
        {
            get { return this.label; }
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitLabelStatement(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitLabelStatement(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Label);

            return builder.ToImmutable();
        }
    }

    public partial class AstBranchStatement : AstStatement
    {
        private readonly AstExpression condition;
        private readonly AstStatement statement;

        internal AstBranchStatement(AstExpression condition, AstStatement statement) : base(AstNodeKind.BranchStatement)
        {
            this.condition = condition;
            this.statement = statement;
        }

        public AstExpression Condition
        {
            get { return this.condition; }
        }

        public AstStatement Statement
        {
            get { return this.statement; }
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitBranchStatement(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitBranchStatement(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Condition);
            builder.Add(Statement);

            return builder.ToImmutable();
        }
    }

    public partial class AstJumpStatement : AstStatement
    {
        private readonly AstLabel label;

        internal AstJumpStatement(AstLabel label) : base(AstNodeKind.JumpStatement)
        {
            this.label = label;
        }

        public AstLabel Label
        {
            get { return this.label; }
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitJumpStatement(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitJumpStatement(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Label);

            return builder.ToImmutable();
        }
    }

    public partial class AstReturnStatement : AstStatement
    {
        private readonly AstExpression expression;

        internal AstReturnStatement(AstExpression expression) : base(AstNodeKind.ReturnStatement)
        {
            this.expression = expression;
        }

        public AstExpression Expression
        {
            get { return this.expression; }
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitReturnStatement(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitReturnStatement(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Expression);

            return builder.ToImmutable();
        }
    }

    public partial class AstQuitStatement : AstStatement
    {
        internal AstQuitStatement() : base(AstNodeKind.QuitStatement)
        {
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitQuitStatement(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitQuitStatement(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            return ImmutableList<AstNode>.Empty;
        }
    }

    public partial class AstStackPushStatement : AstStatement
    {
        private readonly AstExpression value;

        internal AstStackPushStatement(AstExpression value) : base(AstNodeKind.StackPushStatement)
        {
            this.value = value;
        }

        public AstExpression Value
        {
            get { return this.value; }
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitStackPushStatement(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitStackPushStatement(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Value);

            return builder.ToImmutable();
        }
    }

    public partial class AstStackCopyStatement : AstStatement
    {
        private readonly AstExpression count;

        internal AstStackCopyStatement(AstExpression count) : base(AstNodeKind.StackCopyStatement)
        {
            this.count = count;
        }

        public AstExpression Count
        {
            get { return this.count; }
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitStackCopyStatement(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitStackCopyStatement(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Count);

            return builder.ToImmutable();
        }
    }

    public partial class AstWriteLocalStatement : AstStatement
    {
        private readonly AstLocal local;
        private readonly AstExpression value;

        internal AstWriteLocalStatement(AstLocal local, AstExpression value) : base(AstNodeKind.WriteLocalStatement)
        {
            this.local = local;
            this.value = value;
        }

        public AstLocal Local
        {
            get { return this.local; }
        }

        public AstExpression Value
        {
            get { return this.value; }
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitWriteLocalStatement(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitWriteLocalStatement(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Local);
            builder.Add(Value);

            return builder.ToImmutable();
        }
    }

    public partial class AstWriteMemoryStatement : AstStatement
    {
        private readonly AstExpression address;
        private readonly AstExpression value;
        private readonly ValueSize size;

        internal AstWriteMemoryStatement(AstExpression address, AstExpression value, ValueSize size) : base(AstNodeKind.WriteMemoryStatement)
        {
            this.address = address;
            this.value = value;
            this.size = size;
        }

        public AstExpression Address
        {
            get { return this.address; }
        }

        public AstExpression Value
        {
            get { return this.value; }
        }

        public ValueSize Size
        {
            get { return this.size; }
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitWriteMemoryStatement(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitWriteMemoryStatement(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Address);
            builder.Add(Value);

            return builder.ToImmutable();
        }
    }

    public partial class AstOutputCharStatement : AstStatement
    {
        private readonly AstExpression character;

        internal AstOutputCharStatement(AstExpression character) : base(AstNodeKind.OutputCharStatement)
        {
            this.character = character;
        }

        public AstExpression Character
        {
            get { return this.character; }
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitOutputCharStatement(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitOutputCharStatement(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Character);

            return builder.ToImmutable();
        }
    }

    public partial class AstOutputNumberStatement : AstStatement
    {
        private readonly AstExpression number;

        internal AstOutputNumberStatement(AstExpression number) : base(AstNodeKind.OutputNumberStatement)
        {
            this.number = number;
        }

        public AstExpression Number
        {
            get { return this.number; }
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitOutputNumberStatement(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitOutputNumberStatement(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Number);

            return builder.ToImmutable();
        }
    }

    public partial class AstOutputStringStatement : AstStatement
    {
        private readonly AstExpression address;

        internal AstOutputStringStatement(AstExpression address) : base(AstNodeKind.OutputStringStatement)
        {
            this.address = address;
        }

        public AstExpression Address
        {
            get { return this.address; }
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitOutputStringStatement(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitOutputStringStatement(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            var builder = ImmutableList.CreateBuilder<AstNode>();

            builder.Add(Address);

            return builder.ToImmutable();
        }
    }

    public partial class AstRestoreUndoStatement : AstStatement
    {
        internal AstRestoreUndoStatement() : base(AstNodeKind.RestoreUndoStatement)
        {
        }

        public override AstNode Accept(AstRewriter rewriter)
        {
            return rewriter.VisitRestoreUndoStatement(this);
        }

        public override void Accept(AstVisitor visitor)
        {
            visitor.VisitRestoreUndoStatement(this);
        }

        public override ImmutableList<AstNode> ChildNodes()
        {
            return ImmutableList<AstNode>.Empty;
        }
    }

    public abstract partial class AstVisitor
    {
        public virtual void Visit(AstNode node)
        {
            node.Accept(this);
        }

        public void VisitList<TNode>(ImmutableList<TNode> list) where TNode : AstNode
        {
            foreach (var item in list)
            {
                Visit(item);
            }
        }

        public virtual void VisitLabel(AstLabel node)
        {
        }

        public virtual void VisitLocal(AstLocal node)
        {
            Visit(node.Index);
        }

        public virtual void VisitConstantExpression(AstConstantExpression node)
        {
        }

        public virtual void VisitConversionExpression(AstConversionExpression node)
        {
            Visit(node.Expression);
        }

        public virtual void VisitAddExpression(AstAddExpression node)
        {
            Visit(node.Left);
            Visit(node.Right);
        }

        public virtual void VisitSubtractExpression(AstSubtractExpression node)
        {
            Visit(node.Left);
            Visit(node.Right);
        }

        public virtual void VisitMultiplyExpression(AstMultiplyExpression node)
        {
            Visit(node.Left);
            Visit(node.Right);
        }

        public virtual void VisitDivideExpression(AstDivideExpression node)
        {
            Visit(node.Left);
            Visit(node.Right);
        }

        public virtual void VisitModuloExpression(AstModuloExpression node)
        {
            Visit(node.Left);
            Visit(node.Right);
        }

        public virtual void VisitEqualToExpression(AstEqualToExpression node)
        {
            Visit(node.Left);
            Visit(node.Right);
        }

        public virtual void VisitNotEqualToExpression(AstNotEqualToExpression node)
        {
            Visit(node.Left);
            Visit(node.Right);
        }

        public virtual void VisitLessThanExpression(AstLessThanExpression node)
        {
            Visit(node.Left);
            Visit(node.Right);
        }

        public virtual void VisitLessThanOrEqualToExpression(AstLessThanOrEqualToExpression node)
        {
            Visit(node.Left);
            Visit(node.Right);
        }

        public virtual void VisitGreaterThanExpression(AstGreaterThanExpression node)
        {
            Visit(node.Left);
            Visit(node.Right);
        }

        public virtual void VisitGreaterThanOrEqualToExpression(AstGreaterThanOrEqualToExpression node)
        {
            Visit(node.Left);
            Visit(node.Right);
        }

        public virtual void VisitCallExpression(AstCallExpression node)
        {
            Visit(node.Address);
            VisitList(node.Arguments);
        }

        public virtual void VisitCallWithArgCountExpression(AstCallWithArgCountExpression node)
        {
            Visit(node.Address);
            Visit(node.ArgumentCount);
        }

        public virtual void VisitStackPopExpression(AstStackPopExpression node)
        {
        }

        public virtual void VisitReadLocalExpression(AstReadLocalExpression node)
        {
            Visit(node.Local);
        }

        public virtual void VisitReadMemoryExpression(AstReadMemoryExpression node)
        {
            Visit(node.Address);
        }

        public virtual void VisitGetMemorySize(AstGetMemorySize node)
        {
        }

        public virtual void VisitDispatchExpression(AstDispatchExpression node)
        {
            VisitList(node.Arguments);
        }

        public virtual void VisitExpressionStatement(AstExpressionStatement node)
        {
            Visit(node.Expression);
        }

        public virtual void VisitLabelStatement(AstLabelStatement node)
        {
            Visit(node.Label);
        }

        public virtual void VisitBranchStatement(AstBranchStatement node)
        {
            Visit(node.Condition);
            Visit(node.Statement);
        }

        public virtual void VisitJumpStatement(AstJumpStatement node)
        {
            Visit(node.Label);
        }

        public virtual void VisitReturnStatement(AstReturnStatement node)
        {
            Visit(node.Expression);
        }

        public virtual void VisitQuitStatement(AstQuitStatement node)
        {
        }

        public virtual void VisitStackPushStatement(AstStackPushStatement node)
        {
            Visit(node.Value);
        }

        public virtual void VisitStackCopyStatement(AstStackCopyStatement node)
        {
            Visit(node.Count);
        }

        public virtual void VisitWriteLocalStatement(AstWriteLocalStatement node)
        {
            Visit(node.Local);
            Visit(node.Value);
        }

        public virtual void VisitWriteMemoryStatement(AstWriteMemoryStatement node)
        {
            Visit(node.Address);
            Visit(node.Value);
        }

        public virtual void VisitOutputCharStatement(AstOutputCharStatement node)
        {
            Visit(node.Character);
        }

        public virtual void VisitOutputNumberStatement(AstOutputNumberStatement node)
        {
            Visit(node.Number);
        }

        public virtual void VisitOutputStringStatement(AstOutputStringStatement node)
        {
            Visit(node.Address);
        }

        public virtual void VisitRestoreUndoStatement(AstRestoreUndoStatement node)
        {
        }
    }

    public abstract partial class AstRewriter
    {
        public virtual AstNode Visit(AstNode node)
        {
            return node.Accept(this);
        }

        public virtual AstNode VisitLabel(AstLabel node)
        {
            return node;
        }

        public virtual AstNode VisitLocal(AstLocal node)
        {
            var index = (AstExpression)Visit(node.Index);

            return index != node.Index
                ? new AstLocal(index, node.Size)
                : node;
        }

        public virtual AstNode VisitConstantExpression(AstConstantExpression node)
        {
            return node;
        }

        public virtual AstNode VisitConversionExpression(AstConversionExpression node)
        {
            var expression = (AstExpression)Visit(node.Expression);

            return expression != node.Expression
                ? new AstConversionExpression(expression, node.Size, node.Signed)
                : node;
        }

        public virtual AstNode VisitAddExpression(AstAddExpression node)
        {
            var left = (AstExpression)Visit(node.Left);
            var right = (AstExpression)Visit(node.Right);

            return left != node.Left || right != node.Right
                ? new AstAddExpression(left, right)
                : node;
        }

        public virtual AstNode VisitSubtractExpression(AstSubtractExpression node)
        {
            var left = (AstExpression)Visit(node.Left);
            var right = (AstExpression)Visit(node.Right);

            return left != node.Left || right != node.Right
                ? new AstSubtractExpression(left, right)
                : node;
        }

        public virtual AstNode VisitMultiplyExpression(AstMultiplyExpression node)
        {
            var left = (AstExpression)Visit(node.Left);
            var right = (AstExpression)Visit(node.Right);

            return left != node.Left || right != node.Right
                ? new AstMultiplyExpression(left, right)
                : node;
        }

        public virtual AstNode VisitDivideExpression(AstDivideExpression node)
        {
            var left = (AstExpression)Visit(node.Left);
            var right = (AstExpression)Visit(node.Right);

            return left != node.Left || right != node.Right
                ? new AstDivideExpression(left, right)
                : node;
        }

        public virtual AstNode VisitModuloExpression(AstModuloExpression node)
        {
            var left = (AstExpression)Visit(node.Left);
            var right = (AstExpression)Visit(node.Right);

            return left != node.Left || right != node.Right
                ? new AstModuloExpression(left, right)
                : node;
        }

        public virtual AstNode VisitEqualToExpression(AstEqualToExpression node)
        {
            var left = (AstExpression)Visit(node.Left);
            var right = (AstExpression)Visit(node.Right);

            return left != node.Left || right != node.Right
                ? new AstEqualToExpression(left, right)
                : node;
        }

        public virtual AstNode VisitNotEqualToExpression(AstNotEqualToExpression node)
        {
            var left = (AstExpression)Visit(node.Left);
            var right = (AstExpression)Visit(node.Right);

            return left != node.Left || right != node.Right
                ? new AstNotEqualToExpression(left, right)
                : node;
        }

        public virtual AstNode VisitLessThanExpression(AstLessThanExpression node)
        {
            var left = (AstExpression)Visit(node.Left);
            var right = (AstExpression)Visit(node.Right);

            return left != node.Left || right != node.Right
                ? new AstLessThanExpression(left, right)
                : node;
        }

        public virtual AstNode VisitLessThanOrEqualToExpression(AstLessThanOrEqualToExpression node)
        {
            var left = (AstExpression)Visit(node.Left);
            var right = (AstExpression)Visit(node.Right);

            return left != node.Left || right != node.Right
                ? new AstLessThanOrEqualToExpression(left, right)
                : node;
        }

        public virtual AstNode VisitGreaterThanExpression(AstGreaterThanExpression node)
        {
            var left = (AstExpression)Visit(node.Left);
            var right = (AstExpression)Visit(node.Right);

            return left != node.Left || right != node.Right
                ? new AstGreaterThanExpression(left, right)
                : node;
        }

        public virtual AstNode VisitGreaterThanOrEqualToExpression(AstGreaterThanOrEqualToExpression node)
        {
            var left = (AstExpression)Visit(node.Left);
            var right = (AstExpression)Visit(node.Right);

            return left != node.Left || right != node.Right
                ? new AstGreaterThanOrEqualToExpression(left, right)
                : node;
        }

        public virtual AstNode VisitCallExpression(AstCallExpression node)
        {
            var address = (AstExpression)Visit(node.Address);
            var arguments = VisitList(node.Arguments);

            return address != node.Address || arguments != node.Arguments
                ? new AstCallExpression(address, arguments)
                : node;
        }

        public virtual AstNode VisitCallWithArgCountExpression(AstCallWithArgCountExpression node)
        {
            var address = (AstExpression)Visit(node.Address);
            var argumentCount = (AstExpression)Visit(node.ArgumentCount);

            return address != node.Address || argumentCount != node.ArgumentCount
                ? new AstCallWithArgCountExpression(address, argumentCount)
                : node;
        }

        public virtual AstNode VisitStackPopExpression(AstStackPopExpression node)
        {
            return node;
        }

        public virtual AstNode VisitReadLocalExpression(AstReadLocalExpression node)
        {
            var local = (AstLocal)Visit(node.Local);

            return local != node.Local
                ? new AstReadLocalExpression(local)
                : node;
        }

        public virtual AstNode VisitReadMemoryExpression(AstReadMemoryExpression node)
        {
            var address = (AstExpression)Visit(node.Address);

            return address != node.Address
                ? new AstReadMemoryExpression(address, node.Size)
                : node;
        }

        public virtual AstNode VisitGetMemorySize(AstGetMemorySize node)
        {
            return node;
        }

        public virtual AstNode VisitDispatchExpression(AstDispatchExpression node)
        {
            var arguments = VisitList(node.Arguments);

            return arguments != node.Arguments
                ? new AstDispatchExpression(node.Function, arguments)
                : node;
        }

        public virtual AstNode VisitExpressionStatement(AstExpressionStatement node)
        {
            var expression = (AstExpression)Visit(node.Expression);

            return expression != node.Expression
                ? new AstExpressionStatement(expression)
                : node;
        }

        public virtual AstNode VisitLabelStatement(AstLabelStatement node)
        {
            var label = (AstLabel)Visit(node.Label);

            return label != node.Label
                ? new AstLabelStatement(label)
                : node;
        }

        public virtual AstNode VisitBranchStatement(AstBranchStatement node)
        {
            var condition = (AstExpression)Visit(node.Condition);
            var statement = (AstStatement)Visit(node.Statement);

            return condition != node.Condition || statement != node.Statement
                ? new AstBranchStatement(condition, statement)
                : node;
        }

        public virtual AstNode VisitJumpStatement(AstJumpStatement node)
        {
            var label = (AstLabel)Visit(node.Label);

            return label != node.Label
                ? new AstJumpStatement(label)
                : node;
        }

        public virtual AstNode VisitReturnStatement(AstReturnStatement node)
        {
            var expression = (AstExpression)Visit(node.Expression);

            return expression != node.Expression
                ? new AstReturnStatement(expression)
                : node;
        }

        public virtual AstNode VisitQuitStatement(AstQuitStatement node)
        {
            return node;
        }

        public virtual AstNode VisitStackPushStatement(AstStackPushStatement node)
        {
            var value = (AstExpression)Visit(node.Value);

            return value != node.Value
                ? new AstStackPushStatement(value)
                : node;
        }

        public virtual AstNode VisitStackCopyStatement(AstStackCopyStatement node)
        {
            var count = (AstExpression)Visit(node.Count);

            return count != node.Count
                ? new AstStackCopyStatement(count)
                : node;
        }

        public virtual AstNode VisitWriteLocalStatement(AstWriteLocalStatement node)
        {
            var local = (AstLocal)Visit(node.Local);
            var value = (AstExpression)Visit(node.Value);

            return local != node.Local || value != node.Value
                ? new AstWriteLocalStatement(local, value)
                : node;
        }

        public virtual AstNode VisitWriteMemoryStatement(AstWriteMemoryStatement node)
        {
            var address = (AstExpression)Visit(node.Address);
            var value = (AstExpression)Visit(node.Value);

            return address != node.Address || value != node.Value
                ? new AstWriteMemoryStatement(address, value, node.Size)
                : node;
        }

        public virtual AstNode VisitOutputCharStatement(AstOutputCharStatement node)
        {
            var character = (AstExpression)Visit(node.Character);

            return character != node.Character
                ? new AstOutputCharStatement(character)
                : node;
        }

        public virtual AstNode VisitOutputNumberStatement(AstOutputNumberStatement node)
        {
            var number = (AstExpression)Visit(node.Number);

            return number != node.Number
                ? new AstOutputNumberStatement(number)
                : node;
        }

        public virtual AstNode VisitOutputStringStatement(AstOutputStringStatement node)
        {
            var address = (AstExpression)Visit(node.Address);

            return address != node.Address
                ? new AstOutputStringStatement(address)
                : node;
        }

        public virtual AstNode VisitRestoreUndoStatement(AstRestoreUndoStatement node)
        {
            return node;
        }
    }

    public static partial class AstFactory
    {
        public static AstLabel Label(int index)
        {
            return new AstLabel(index);
        }

        public static AstLocal Local(AstExpression index, ValueSize size)
        {
            return new AstLocal(index, size);
        }

        public static AstConversionExpression ConversionExpression(AstExpression expression, ValueSize size, bool signed)
        {
            return new AstConversionExpression(expression, size, signed);
        }

        public static AstEqualToExpression EqualToExpression(AstExpression left, AstExpression right)
        {
            return new AstEqualToExpression(left, right);
        }

        public static AstNotEqualToExpression NotEqualToExpression(AstExpression left, AstExpression right)
        {
            return new AstNotEqualToExpression(left, right);
        }

        public static AstLessThanExpression LessThanExpression(AstExpression left, AstExpression right)
        {
            return new AstLessThanExpression(left, right);
        }

        public static AstLessThanOrEqualToExpression LessThanOrEqualToExpression(AstExpression left, AstExpression right)
        {
            return new AstLessThanOrEqualToExpression(left, right);
        }

        public static AstGreaterThanExpression GreaterThanExpression(AstExpression left, AstExpression right)
        {
            return new AstGreaterThanExpression(left, right);
        }

        public static AstGreaterThanOrEqualToExpression GreaterThanOrEqualToExpression(AstExpression left, AstExpression right)
        {
            return new AstGreaterThanOrEqualToExpression(left, right);
        }

        public static AstCallExpression CallExpression(AstExpression address, ImmutableList<AstExpression> arguments)
        {
            return new AstCallExpression(address, arguments);
        }

        public static AstCallWithArgCountExpression CallWithArgCountExpression(AstExpression address, AstExpression argumentCount)
        {
            return new AstCallWithArgCountExpression(address, argumentCount);
        }

        public static AstStackPopExpression StackPopExpression()
        {
            return new AstStackPopExpression();
        }

        public static AstReadLocalExpression ReadLocalExpression(AstLocal local)
        {
            return new AstReadLocalExpression(local);
        }

        public static AstReadMemoryExpression ReadMemoryExpression(AstExpression address, ValueSize size)
        {
            return new AstReadMemoryExpression(address, size);
        }

        public static AstGetMemorySize GetMemorySize()
        {
            return new AstGetMemorySize();
        }

        public static AstDispatchExpression DispatchExpression(DispatchFunction function, ImmutableList<AstExpression> arguments)
        {
            return new AstDispatchExpression(function, arguments);
        }

        public static AstExpressionStatement ExpressionStatement(AstExpression expression)
        {
            return new AstExpressionStatement(expression);
        }

        public static AstLabelStatement LabelStatement(AstLabel label)
        {
            return new AstLabelStatement(label);
        }

        public static AstBranchStatement BranchStatement(AstExpression condition, AstStatement statement)
        {
            return new AstBranchStatement(condition, statement);
        }

        public static AstJumpStatement JumpStatement(AstLabel label)
        {
            return new AstJumpStatement(label);
        }

        public static AstReturnStatement ReturnStatement(AstExpression expression)
        {
            return new AstReturnStatement(expression);
        }

        public static AstQuitStatement QuitStatement()
        {
            return new AstQuitStatement();
        }

        public static AstStackPushStatement StackPushStatement(AstExpression value)
        {
            return new AstStackPushStatement(value);
        }

        public static AstStackCopyStatement StackCopyStatement(AstExpression count)
        {
            return new AstStackCopyStatement(count);
        }

        public static AstWriteLocalStatement WriteLocalStatement(AstLocal local, AstExpression value)
        {
            return new AstWriteLocalStatement(local, value);
        }

        public static AstWriteMemoryStatement WriteMemoryStatement(AstExpression address, AstExpression value, ValueSize size)
        {
            return new AstWriteMemoryStatement(address, value, size);
        }

        public static AstOutputCharStatement OutputCharStatement(AstExpression character)
        {
            return new AstOutputCharStatement(character);
        }

        public static AstOutputNumberStatement OutputNumberStatement(AstExpression number)
        {
            return new AstOutputNumberStatement(number);
        }

        public static AstOutputStringStatement OutputStringStatement(AstExpression address)
        {
            return new AstOutputStringStatement(address);
        }

        public static AstRestoreUndoStatement RestoreUndoStatement()
        {
            return new AstRestoreUndoStatement();
        }
    }
}
